apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: orchestration-apps
  namespace: argocd
spec:
  description: "Infrastructure orchestration and management applications"
  sourceRepos:
  - 'https://github.com/vsem-svoim/base-app-layer.git'
  - 'https://github.com/vsem-svoim/base-app-layer.git'
  - 'https://charts.crossplane.io/stable'
  - 'https://charts.jetstack.io'
  - 'https://kubernetes.github.io/ingress-nginx'
  - 'https://external-secrets.github.io/charts'

  destinations:
  - namespace: 'crossplane-system'
    server: https://kubernetes.default.svc
  - namespace: 'cert-manager'
    server: https://kubernetes.default.svc
  - namespace: 'external-secrets'
    server: https://kubernetes.default.svc
  - namespace: 'ingress-nginx'
    server: https://kubernetes.default.svc

  clusterResourceWhitelist:
  - group: '*'
    kind: '*'

  namespaceResourceWhitelist:
  - group: '*'
    kind: '*'

  roles:
  - name: orchestration-admin
    description: "Infrastructure orchestration administrators"
    policies:
    - p, proj:orchestration-apps:orchestration-admin, applications, *, orchestration-apps/*, allow
    groups:
    - platform-engineering
    - infrastructure-team