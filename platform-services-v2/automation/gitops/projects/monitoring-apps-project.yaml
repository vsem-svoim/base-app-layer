apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: monitoring-apps
  namespace: argocd
spec:
  description: "Monitoring and observability applications"
  sourceRepos:
  - 'https://github.com/vsem-svoim/base-app-layer.git'
  - 'https://prometheus-community.github.io/helm-charts'
  - 'https://grafana.github.io/helm-charts'
  - 'https://jaegertracing.github.io/helm-charts'

  destinations:
  - namespace: 'monitoring'
    server: https://kubernetes.default.svc
  - namespace: 'observability'
    server: https://kubernetes.default.svc
  - namespace: 'logging'
    server: https://kubernetes.default.svc
  - namespace: 'tracing'
    server: https://kubernetes.default.svc

  clusterResourceWhitelist:
  - group: '*'
    kind: '*'

  namespaceResourceWhitelist:
  - group: '*'
    kind: '*'

  roles:
  - name: monitoring-admin
    description: "Monitoring platform administrators"
    policies:
    - p, proj:monitoring-apps:monitoring-admin, applications, *, monitoring-apps/*, allow
    groups:
    - platform-engineering
    - sre