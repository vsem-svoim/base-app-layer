apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: base-layer
  namespace: argocd
spec:
  description: "BASE layer components management"
  sourceRepos:
  - 'https://github.com/vsem-svoim/base-app-layer.git'
  - 'https://github.com/vsem-svoim/base-app-layer.git'
  - 'https://charts.jetstack.io'

  destinations:
  - namespace: 'base-*'
    server: https://kubernetes.default.svc
  - namespace: 'kube-system'
    server: https://kubernetes.default.svc

  clusterResourceWhitelist:
  - group: '*'
    kind: '*'

  namespaceResourceWhitelist:
  - group: '*'
    kind: '*'

  roles:
  - name: base-admin
    description: "BASE layer administrators"
    policies:
    - p, proj:base-layer:base-admin, applications, *, base-layer/*, allow
    groups:
    - platform-engineering